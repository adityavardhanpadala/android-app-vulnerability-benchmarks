# Summary
Apps that allow any sensitive information to *copy on clipboard* are vulnerable
to *information exposure* attacks.  

# Android versions affected
Tested on Android 4.4 - Android 7.1

# Description of vulnerability and corresponding exploit
Every Android app has access to *clipboard* since Android clipboard is globally accessible by every app.
If an app is using *clipboard* to store sensitive information then every other app is also having access to the stored sensitive information.

*Issue:* An app which uses *clipboard* to store sensitive information is vulnerable
to *information exposure* attacks. An app can store the information on *clipboard* using the global *ClipboardManager* class. When any app allows users to copy information it will be stored *clipboard* and will be available to all other apps. If app allows users to copy sensitive information then that information is also available to every other app and in such cases malign app can take advantage of this inherent information exposure provided by Android.     

*Example:* This vulnerability is demonstrated by *Benign*  and *Malicious*. *Benign* app has textfields to enter username and password.
*Benign* app provides a button which allows user to copy password on clipboard and then paste it wherever they want. *Malicious* app has a listener which triggers if the *clipboard's contents* changes and tracks these changes which leads to *information exposure*.

*Note:* We manually tested benchmark on APIs 19 to 25 and it behaves as expected. For instrumentation testing of benchmark we created a button to copy text from *EditText* to *clipboard*, because UiAutomator is not able to detect dialog box which pops-up after long-clicking the *EditText*.  

# Steps to build the sample apps and to exploit the vulnerability

1. List targets:

    `$ android list targets`

2. List available Android Virtual Devices:

    `$ android list avd`

3. Create an emulator:

    `$ android create avd -n <name> -t <target>`

    *<target>* is obtained from the command listed in 1. *<name>* is the name you choose to give to the avd.

4. Start emulator:

    `$ emulator -avd <avd_name>`

    *<avd-name>* is obtained from the command listed in 2.

5. Build and install *Benign*:

    `$ cd Benign`

    Make sure there is a file called local.properties with an entry sdk=/path/to/Android/sdk. Build will fail without this.

    `$ ./gradlew installDebug`

6. Build and install *Malicious*:

    `$ cd Malicious`

    Make sure there is a file called local.properties with an entry sdk=/path/to/Android/sdk. Build will fail without this.

    `$ ./gradlew installDebug`

7. Launch *Malicious* in the emulator where it is installed.

8. Launch *Benign* in the emulator where it is installed.
9.  Enter username and password, and then either press *COPY-PASS* button or copy the contents of password by long clicking on password and then selecting *copy* option.
10. Bring *Malicious* to foreground.

    You will see the copied contents displayed on screen.

# Reference

[Security Smells in Android](http://scg.unibe.ch/archive/papers/Ghaf17c.pdf)
