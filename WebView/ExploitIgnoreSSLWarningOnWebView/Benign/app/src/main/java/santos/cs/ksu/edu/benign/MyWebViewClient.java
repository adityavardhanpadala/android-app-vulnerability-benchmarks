package santos.cs.ksu.edu.benign;

import android.net.http.SslError;
import android.os.Handler;
import android.util.Log;
import android.webkit.SslErrorHandler;
import android.webkit.WebResourceRequest;
import android.webkit.WebResourceResponse;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.Toast;

/**
 * Created by Joy on 4/5/17.
 */

public class MyWebViewClient extends WebViewClient {

    private static final String TAG = "WebViewSSLErr";
    /*
    ignores SSL errors
     */
    @Override
    public void onReceivedSslError(WebView view , SslErrorHandler handler ,
                                   SslError error){
        Log.d(TAG,"SSL error detected");
        handler.proceed();
    }


    /*
    allows any url to load in the webview.
    The method is not called for requests using a POST method
     */
    @Override
    public boolean shouldOverrideUrlLoading(WebView wv, String url){
        return false;
    }

    /*
    This incorrect implementation allows any url to load in the webview.
    The method is not called for requests using a POST method
     */
    @Override
    public boolean shouldOverrideUrlLoading(WebView wv, WebResourceRequest req){
        Log.d(TAG,"Override URL");
        String host = req.getUrl().getHost();
        if(host.startsWith("https://people.cs.ksu.edu")){
            return false;
        }
        else return super.shouldOverrideUrlLoading(wv,req);
    }

    /*
    Returning null allows any url to load in the webview.
     */
    @Override
    public WebResourceResponse shouldInterceptRequest(WebView wv, WebResourceRequest req){
        return null;
    }

    /*
    Returning null allows any url to load in the webview.
     */
    @Override
    public WebResourceResponse shouldInterceptRequest(WebView wv, String url){
        return null;
    }


}
