# Summary
Apps that do not validate request URLs before loading them into a WebView are vulnerable to loading
malicious web content.

# Android versions affected
Tested on Android 4.2 - Android 7.1

# Description of vulnerability and corresponding exploit
An Android app can display web pages by loading HTML/JavaScript files in a *WebView*. The loaded
HTML/JavaScript file runs in the context of the app i.e. it has access to the same resources and has the
same permissions the app has. Therefore, it is vital to validate the URL being loaded especially if
the URL comes from user input or is read from a file accessible to other apps. Android provides
the *shouldInterceptRequest()* method in the *WebClient* API that can be used to intercept the
request from a WebView. This method is called every time the WebView requests to load some web content
in the WebView.

*Issue:* *shouldInterceptRequest()* takes an instance of WebView and the request as input and returns a
response. If the response returned is null then it just forwards the request to the URL in the request
and displays the response from the URL in the WebView. If this method returns null all the time then
any URL can be loaded into the WebView including malicious URLs. By default this method always returns null.
A correct implementation of this method should return null only for valid URLs.

*Example:* An example of such a vulnerability is shown in *WebViewInterceptRequest-MITM/Benign*. The
*MainActivity* of this app has a WebView which loads a URL provided by the user of the app which means that
the URL can be anything. The app contains *MyWebViewClient* which extends the default *WebClient* and
overrides the *shouldInterceptRequest()* method. The method just returns null which means that any URL
including malicious URLs can be loaded into the WebView. If a malicious URL has JavaScript embedded in it
then it will be executed in the context of the app.


# Steps to build the sample apps and re-produce the exploit

1. list targets:

    $ android list targets

2. available Android Virtual Devices:

    $ android list avd

3.  create an emulator:

    $ android create avd -n <name> -t <target>

4.  start emulator:

    $ emulator -avd <avd_name>

5. build and install *Benign*:

    $ cd Benign

    Make sure there is a file called local.properties with an entry sdk=/path/to/Android/sdk. Build will fail without this.

    $ ./gradlew installDebug
