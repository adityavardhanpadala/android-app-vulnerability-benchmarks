# Summary
Apps that do not check for the validity of a Certificate Authority when communicating with a server are 
vulnerable to MITM attacks.   

# Android versions affected
Tested on Android 4.2 - Android 7.1

# Description of vulnerability and corresponding exploit
Android apps can use SSL/TLS to securely communicate with a web server. When an app wants to connect with 
a web server, it requests the web server for a certificate signed by a certificate authority that the app
trusts. Every Android device comes with a list of pre-installed Certificate Authorities that it trusts.
All apps running on that device inherit the the trusted list of Certificate Authorities. When 


*Issue:* If the webcontent is loaded from an insecure source then an attacker can execute malicious 
JavaScript inside the WebView. If the WebView has access to the the app's internal resources or has
permission to perform privileged operations then the malicious JavaScript inside the WebView will also
have the same ability.

*Example:* An example of such a vulnerability is shown in *ExploitAllowFileAccessWebView/Benign*. The
*MainActivity* of this app has a WebView which loads an HTML file from an internal file system. 
The WebView uses *WebSetting.setJavaScriptEnable(true)* to enable JavaScript to execute in its context and 
uses *WebSetting.setAllowFileAccessFromFileURLs(true)* to enable URLs with file scheme to access files
in the app's internal file system. Note that this is secure because the web page is loaded from a file
in the internal file-system. However, the web page includes a JavaScript source from an Http server which
gets loaded into the WebView when the file URL is loaded. The JavaScript source will execute in the same
context as that of the file URL which means that the JavaScript will execute in the context of the WebView
and because of *WebSetting.setJavaScriptEnable(true)* and *WebSetting.setAllowFileAccessFromFileURLs(true)*
it will be able to access files in the internal file system. Since, the JavaScript is being loaded from
an Http server it is not secure because a man in the middle can easily inject malicious JavaScript code
and read/write/execute files in the internal file system of the app.


# Steps to re-produce the exploit automatically
Coming soon.



