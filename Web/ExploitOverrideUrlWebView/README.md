# Summary
A WebView that does not validate requests to resources made from within it is vulnerable to loading 
malicious content in it. 

# Android versions affected
Tested on Android 4.2 - Android 7.1

# Description of vulnerability and corresponding exploit
An Android app can display web pages by loading HTML/JavaScript files in a *WebView*. The loaded
HTML/JavaScript file runs in the context of the app i.e. it has access to the same resources and has the
same permissions the app has. If a user interactively requests a resource from within the WebView then
the app can choose to display the response in the WebView instead of a browser by using the WebViewClient
API. All responses to the WebView are routed through the WebViewClient. Android provides call back methods
in the WebViewClient through which one can check if the URL to which the request is being sent is valid. 
One such method is *shouldOverrideUrlLoading()*. 

*Issue:* *shouldOverrideUrlLoading()* takes an instance of WebView and the request as input and returns a
boolean. If true is returned then the host application handles the request else if false is returned then 
the current WebView handles the request. If the method always returns false, then all URLs including malicous
ones can be loaded into the WebView.

*Example:* An example of such a vulnerability is shown in *ExploitOverrideUrlWebView/Benign*. The
*MainActivity* of this app has a WebView which loads a *http* URL which means that a man in the middle
can embed malicious URLs into it. The app contains *MyWebViewClient* which extends the default *WebClient* and
overrides the *shouldOverrideUrlLoading()* method. The method just returns false which means that any URL
including malicious URLs can be loaded into the WebView. If a malicious URL has JavaScript embedded in it
then it will be executed in the context of the app.

Note that the default *shouldOverrideUrlLoading()* returns false all the time.  


# Steps to re-produce the exploit automatically
Coming soon.
