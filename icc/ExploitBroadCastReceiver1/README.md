# Summary of the Vulnerability
A broadcast receiver registered to receive system broadcast does not check for validity of the broadcast message before performing an operation 

# Versions of Android where the vulnerability is possible
All versions.

# Sample list of apps that exhibit the vulnerability
Yet to be explored.

# Description of the vulnerability and the corresponding exploit.
The Android system broadcasts a notification to all broadcast receivers that register to receive the notification when certain events occur. Typically a broadcast receiver will specify in the manifest file that it can receive such messages via the <intent-filter> tag.
When the action string in the message being broadcast by the system matches with the string in the <intent-filter> tag, the corresponding broadcast receiver's *onReceive()* method is invoked. The problem is whenever a broadcast recevier specifies an <intent-filter>
it gets exported by default which means that the broadcast receiver can be invoked even if the intended system event did not occur.

For example, AndroidManifest.xml in *ExploitBroadCastReceiver1/Benign/app/src/main* has LowMemoryReceiver broadcast receiver in the <receiver> tag. It contains a <intent-filter> with *android.intent.action.DEVICE_STORAGE_LOW*. This means that it registered to receive a notification from the system when the device is low on memory.
When LowMemoryReceiver is notified it calls a service to delete all files in the internal storage of the app. Due to the presence of the <intent-filter> it also means that it can be invoked by any other component. 
Consequently, a malicious app can send an explicit intent to LowMemoryReceiver and delete all files in the benign app's internal memory. See *MalActivity.java* in *ExploitBroadCastReceiver1/Malicious/app/src/main/java/.../MalActivity.java*.  


# Pre-requisites for build
[Android Studio](https://developer.android.com/studio/index.html)

# Steps to build the sample apps and re-produce the apps in Android Studio
1.	Open Android Studio
2.	Go to Open Existing Project
3. 	Browse to ../ExploitBroadCastReceiver1/Benign
4.	Go to Run->Run app
5.	If devices is connected or emulator is running then app is launched.
6.	If device or emulator not connected then either connect a device or choose an existing emulator or click on "Create New Android Virtual Device".
7.	If you connected a dvice then app will be launched in the device. If you launched an existing emulator then app will be launched in the emulator. If you created a new virtual device then select it and launch the app in it.
8.	Verify if "myfile" was created in the internal file-system of the app:

$ <path-to-android-sdk>/platform-tools/adb shell run-as "edu.ksu.cs.santos.benign"	
$ ls files

9.	Go to File->Open Existing Project.
10.	Go to Run->Run app and launch the app in which you installed/launched ExploitBroadCastReceiver1/Benign
11. You can verify if the file has been deleted by running adb:

$ <path-to-android-sdk>/platform-tools/adb shell run-as "edu.ksu.cs.santos.benign"	
$ ls files

# Steps to build the sample apps and re-produce the apps automatically
Coming soon