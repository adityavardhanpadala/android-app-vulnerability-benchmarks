# Summary of the Vulnerability
A broadcast receiver registered to receive system broadcast does not check for validity of the broadcast message before performing corresponding operations. 

# Versions of Android where the vulnerability is possible
All versions. _[As it been tested on all versions?]_

# Sample list of apps that exhibit the vulnerability
_Yet to be explored._

# Description of the vulnerability and the corresponding exploit.
In Android, a broadcast receiver can register to receive messages.  Typically, a broadcast receiver expresses its interest in messages by specifying corresponding string identifiers in <intent-filter> tags in its manifest file.  When Android system receives a message for broadcasting, it delivers the message to every broadcast receiver who specified a string identifier (via <intent-filter> tags) that matches the action string of the message.

*Issue:* Since the use of a <intent-filter> tag automatically exports the corresponding broadcast receiver and the message delivery is push-based, the broadcast receiver can be triggered by an appropriate message from any app, including unintended apps. 

*Example:* AndroidManifest.xml in *ExploitBroadCastReceiver1/Benign/app/src/main* has _LowMemoryReceiver_ broadcast receiver in the <receiver> tag. It contains a <intent-filter> with *android.intent.action.DEVICE_STORAGE_LOW*.  This registers _LowMemoryReceiver_ to receive messages from the system when the device is low on memory. _[If the registration is for messages from the system, then it does not seem to be a vulnerability.  If not, then the previous statement needs to be modified.]_
When _LowMemoryReceiver_ is notified it calls a service to delete all files in the internal storage of the app. Due to the presence of the <intent-filter> it also means that it can be invoked by any other component. 
Consequently, a malicious app can send an explicit intent to LowMemoryReceiver and delete all files in the benign app's internal memory. See *MalActivity.java* in *ExploitBroadCastReceiver1/Malicious/app/src/main/java/.../MalActivity.java*.  


# Pre-requisites for build
[Android Studio](https://developer.android.com/studio/index.html) _[Are there any version restrictions?  If so, what?]_

# Steps to build the sample apps and re-produce the apps in Android Studio
1.	Open Android Studio
2.	Go to Open Existing Project
3. 	Browse to ../ExploitBroadCastReceiver1/Benign
4.	Go to Run->Run app
5.	If devices is connected or emulator is running then app is launched.
6.	If device or emulator not connected then either connect a device or choose an existing emulator or click on "Create New Android Virtual Device".
7.	If you connected a dvice then app will be launched in the device. If you launched an existing emulator then app will be launched in the emulator. If you created a new virtual device then select it and launch the app in it.
8.	Verify if "myfile" was created in the internal file-system of the app:

$ <path-to-android-sdk>/platform-tools/adb shell run-as "edu.ksu.cs.santos.benign"	
$ ls files

9.	Go to File->Open Existing Project.
10.	Go to Run->Run app and launch the app in which you installed/launched ExploitBroadCastReceiver1/Benign
11. You can verify if the file has been deleted by running adb:

$ <path-to-android-sdk>/platform-tools/adb shell run-as "edu.ksu.cs.santos.benign"	
$ ls files

# Steps to build the sample apps and re-produce the apps automatically
Coming soon