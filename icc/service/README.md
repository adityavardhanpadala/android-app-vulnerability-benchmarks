An Android Service is an application component that can perform long-running operations in the background. Some of these operations can deal with sensitive information. Therefore, it is important for application developers to ensure that the services that they design are not leaking sensitive information or are not exposing interfaces not meant for public consumption. 

The *benignServices* folder contains sample code demonstrating ways that services can be insecure.

The *benignServicesExploits* folder contains sample code that exploits the benign insecure services.

Summary
============

Application components can interact with services in one of the following ways:

1.	Intents (Only explicit intents from Android 5.0)
2.	Messenger
3.	AIDL 

1.) is secure if one uses explicit intents to communicate with the service. Using implicit intents to communicate with a service can lead to man-in-the-middle attacks. Using intents is quite safe for Android 5.0 and later because Android 5.0 and later disallow using implicit intents with services. However, even while using explicit intents the client must carefully set the package name and the class name of the service it wants to interact with. Malicious services can have package names very similar to benign services. Setting the incorrect package name will cause the client to interact with the malicious service instead. See sample code here *provide link*

2.) Android provides the Messenger and Handler classes to enable interaction with remote services. Clients can bind to a service (using explicit intents) and receive a handler to the onHandleMessage method of the remote service. All interaction with the service happens only via the onHandleMessage method. The onHandleMessage queues the messages from multiple clients and handles them on a first-com-first serve basis. If the onHandleMessage performs sensitive operations based on a particular message from a client, it is possible for a malicious client to inject that message and exploit the service. Therefore, service providers using this method should take care that along with verifying the message received, the identity of the client should also be verified. See sample code here *provide link*. 

3.) AIDL is the Android Interface Definition Language for defining interfaces to public methods in a service. A service provider has to create an AIDL interface of the public methods it wants to expose. All clients should have this AIDL interface in order to interact with the service. Service providers should be careful as to what they expose through the interface because a malicious client can easily re-crete the AIDL file from the service provider's apk file, include it in its package and interact with it. See sample code here *provide link*.

Lastly, note that services meant for internal consumption should have their exported flag set as false and should not contain any intent-filter attributes. Services can be exported by setting the *Android:exported* attribute to true or by assigning *intent-filter* attributes. Exported services should be protected with dangerous-level permissions. Services shared by partner apps should be protected by signature-level permissions. However, protecting apps with permissions (especially dangerous-level) doesn't guarantee their security. 