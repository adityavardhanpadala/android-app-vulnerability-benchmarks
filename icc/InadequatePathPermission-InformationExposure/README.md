#Summary
Inadequate path permission used to protect a content provider providing sensitive information to authorized clients allows a malicious app access to sensitive information.     

#Versions of Android in which the vulnerability can occur
Testes on Android 4.2 - Android 7.0

#Sample list of apps that exhibit the vulnerability
Yet to be explored.

#Description of the vulnerability and corresponding exploit
Content Providers in Android provide an interface to components through which they can interact with the underlying data store.
Components running in the same process as that of the content provider have unlimited access to its methods.
If a content provider is *exported* then components running in processes other than its own also have unlimited access to its methods.
However, a content provider can limit access to components running in processes other than its own via *permissions*.
A permission can be declared to limit access to all of the data provided by the content provider or to a subset of the data provided by the content provider.
The content provider can do the latter by specifying <path-permission android:readPermission="some.string.identifier" android:path="some/path">
or <path-permission android:readPermission="some.string.identifier" android:pathPrefix="some/prefix"> or <path-permission android:readPermission="some.string.identifier" android:pathPattern="some/pattern">.

1.	android:path means that the permission applies to the exact path declared in android:path
2.	android:pathPrefix means that the permission applies to the any path beginning with the value declared in pathprefix.
3.	android:pathPattern means that the permission applies to any pattern that matches the value in android:pathPattern. android:pathPattern accepts two wildcard characters, "*" i.e. sequence of 0 to many occurrences of the immediately preceding character, and ".*" i.e. sequence of 0 or more characters.

*Issue:* A vulnerbalility can occur if a content provider mistakenly exposes a subset of data that it was supposed to keep private, to other apps.  

*Example:* The *AndroidManifest.xml* file in *InadequatePathPermission-InformationExposure/benign/app/src/main* defines a content provider called *UserDetailsContentProvider* in the <provider> tag. This *UserDetailsContentProvider* is protected with a read permission i.e. components running in other processes need to ask the user for this permission to read from the content provider.
It is protected with an additional read permission on the path */user* as specified in the *<path-permission>* tag, which means that among the components running in processes other than the content provider's, only those that belong to the same developer can be granted this permission.
All other requests will be disallowed by the system. The vulnerability exists because */user/ssn* contains sensitive information. The developer protected */user* and mistakenly assumed that this would protect */user* and all paths under */user* including */user/ssn*.
However, the assumption is incorrect. The sample malicious app (in the folder *Malicious*) with read permission to the content provider, is able to query the content provider and retrieve sensitive information in */user/ssn*.

#Pre-requisites for build

[Android Studio](https://developer.android.com/studio/index.html)

#Steps to build the sample apps and re-produce the exploit with Android Studio
1.	Open Android Studio.
2. 	Click on open existing projects.
3. 	Browse to *InadequatePathPermission-InformationExposure/Benign*
4. 	Go to run and click on run app.
5.	If device/emulator is connected then select the device/emulator
6.	If no emulator exists or no device is connected then you will be prompted to create an emulator.
7.	Click on create on Android Virtual Device and follow the instructions.
8.	After the emulator is launched you will see the benign app in the emulator.
9.	Go to File->Open and browse to     *InadequatePathPermission-InformationExposure/Malicious*.
10.	Repeat step 4.
11.	Open a terminal.
12.	$ <path-to-Android>/sdk/platform-tools/adb shell run-as "edu.ksu.cs.santos.benign"
13.	$ cd files
14.	$ mkdir mockData
15.	Inside mockData create a file called User.csv and two directories address, ssn.
16.	Inside address and ssn create a file called Table1.csv. Populate the files with some comma separated values.
17.	Make sure that ssn/Table1.csv has an entry *1,<some number>*. This is the entry we will retrieve in the malicious app.
18.	Go to the already launched emulator/device.
19.	Click on the button "Get SSN". You will see a number appear below the button. This is the number in *ssn/Table1.csv*

#Steps to build the sample apps and re-produce the exploit in Terminal
Coming soon.
