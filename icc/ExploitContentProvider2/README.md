#Summary of the vulnerability
Inadequate path permission used to protect a content provider with sensitive information allows a malicious app access to sensitive information.     

#Versions of Android in which the vulnerability can occur
All versions.

#Sample list of apps that exhibit the vulnerability
Yet to be explored.

#Description of the vulnerability and corresponding exploit
Content Providers in Android provide an interface to components through which they can interact with the underlying data store. Components running in the same process as that of the content provider have unlimited access to its methods. If a content provider is *exported* then components running in processes other than its own also have unlimited access to its methods. However, a content provider can limit access to components running in processes other than its own via permissions.
For example, the *AndroidManifest.xml* file in *ExploitContentProvider2/benign/app/src/main* defines a content provider called *UserDetailsContentProvider* in the <provider> tag. This content provider is protected with a read permission i.e. components running in other processes need to ask the user for this permission to read from the content provider. It is protected with an additional read permission on the path */user* as specified in the *<path-permission>* tag, which means that among the components running in processes other than the content provider's, only those that belong to the same developer can be granted this permission. All other requests will be disallowed by the system.
The vulnerability exists because */user/ssn* contains sensitive information. The developer protected */user* and mistakenly assumed that this would protect */user* and all paths under */user* including */user/ssn*. However, the assumption is incorrect. The sample malicious app (in the folder *Malicious*) with read permission to the content provider, is able to query the content provider and retrieve sensitive information in */user/ssn*. 

#Pre-requisites for build

<p><a href="https://developer.android.com/studio/index.html">Android Studio</a></p>

#Steps to build the sample apps and re-produce the exploit in Android Studio
1. Open Android Studio.
2. Click on open existing projects.
3. Browse to *ExploitContentProvider2/Benign*
4. Go to run and click on run app.
5. If device/emulator is connected then select the device/emulator
6. If no emulator exists or no device is connected then you will be prompted to create an emulator.
7. Click on create on Android Virtual Device and follow the instructions.
8. After the emulator is launched you will see the benign app in the emulator.
9. Go to File->Open and browse to *ExploitContentProvider2/Malicious*.
10. Repeat step 4.
11. Open a terminal.
..* $ <path-to-Android>/sdk/platform-tools/adb shell run-as "edu.ksu.cs.santos.benign"
..*	$ cd files
..*	$ mkdir mockData
12. Inside mockData create a file called User.csv and two directories address, ssn.
13. Inside address and ssn create a file called Table1.csv. Populate the files with some comma separated values.
14. Make sure that ssn/Table1.csv has an entry *1,<some number>*. This is the entry we will retrieve in the malicious app. 
15. Go to the already launched emulator/device. 
16. Click on the button "Get SSN". You will see a number appear below the button. This is the number in *ssn/Table1.csv*

#Steps to build the sample apps and re-produce the exploit in Terminal
Coming soon.