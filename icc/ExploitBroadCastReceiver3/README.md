# Summary of the Vulnerability
A broadcast receiver registered dynamically is exported by default.

# Versions of Android where the vulnerability is possible
All versions.

# Sample list of apps that exhibit the vulnerability
Yet to be explored.

# Description of the vulnerability and the corresponding exploit.
Broadcast Receivers can register themselves to listen to broadcasts statically in the manifest file or they be registered dynamically as part of the lifecycle of an activity. 
An example of this could be a broadcast receiver that is registered when an activity gets created and is unregistered when the activity is destroyed. When user leaves the particular activity
the broadcast receiver registered with this activity is notified and an email is sent to the app's developers informing them that the user left the app after interacting with it for lets say x minutes.
Clearly this was meant to be a local broadcast receiver and this feature could have been implemented with a LocalBroadCastReceiver. However, since the developers registered the BroadCastReceiver dynamically it got exported by default.
A malicious app can invoke this BroadCastReceiver and exploit it to send emails even if the malicious app is not authorized to send emails. Sending email is not very dangerous but the broadcast receiver exposed accidentally 
could very well be performing a more dangerous operation.


# Pre-requisites for build
[Android Studio](https://developer.android.com/studio/index.html)

# Steps to build the sample apps and re-produce the apps in Android Studio
1.	Open Android Studio
2.	Go to Open Existing Project
3. 	Browse to ../ExploitBroadCastReceiver3/Benign
4.	Go to Run->Run app
5.	If devices is connected or emulator is running then app is launched.
6.	If device or emulator not connected then either connect a device or choose an existing emulator or click on "Create New Android Virtual Device".
7.	If you are connected to a device then app will be launched in the device. If you launched an existing emulator then app will be launched in the emulator. If you created a new virtual device then select it and launch the app in it.
8.  Go to File->Open abd browse to ../ExploitBroadCastReceiver3/Malicious.
9.  Go to Run->Run app and install/launch the malicious app in the same emulator/device in which the benign app was installed/launched.
10. Check the log of the benign app by clicking on "AndroidMonitor" at the bottom of the screen.
11. If the log contains a message "An email will be sent to rookie@malicious.com", you will know that the benign broadcast receiver was succesfully invoked by the malicious app.

# Steps to build the sample apps and re-produce the apps automatically
Coming soon