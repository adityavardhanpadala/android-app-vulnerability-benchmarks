# Summary
Using implicit intent to start a service allows malicious app to hijack the service.

# Versions of Android where the vulnerability is possible
Up to Android 4.4

# Sample list of apps that exhibit the vulnerability
Yet to be explored.

# Description of the vulnerability and the corresponding exploit.
*Description:* A service can be started via an implicit intent or an explicit intent. An explicit intent contains the package name and the class name of the
service that needs to be started so the Android system will always knwo which service to start. Implicit intents on the other hand have a
string identifier which the android system uses to resolve the service to start. This string identifier can correspond to more than one service.

*Issue:* A malicious app can contain a service with the same string identifier used to resolve a service in a benign app. When an implcit intent
is used to start the service in the benign app usin the string identifier, the android system will not know which service to start so it start
a service at random. The situation is more dangerous because a service can specify a priority. In case of a conflict like the one we are describing,
a service with the higher priority will be started. This means that a malicious service can specify a higher priority than the benign service
and hijack all communication to and from the benign service.

*Example:* This illustrated by a pair of beinign and malicious apps in icc/Benign and icc/Malicious. The Benign app has a service *MyService*.
The Benign app uses an implicit intent to start *MyService*. The malicious app has a malicious service with the same string identifier or
*intent-filter* as the benign service but with a higher priority. When *Benign/MyService* is started then the service in the malicious app
will be started in its place.

# Pre-requisites for build
Tested with Android Studio 2.3. Download [Android Studio](https://developer.android.com/studio/index.html)

# Steps to build the sample apps and re-produce the apps in Android Studio
1.	Open Android Studio
2.	Go to Open Existing Project
3. 	Browse to ../ImplicitIntent-ServiceHijack/Malicious
4.	Go to Run->Run app
5.	If devices is connected or emulator is running then app is launched.
6.	If device or emulator not connected then either connect a device or choose an existing emulator or click on "Create New Android Virtual Device".
7.	If you connected a device then app will be launched in the device. If you launched an existing emulator then app will be launched in the emulator. If you created a new virtual device then select it and launch the app in it.
8.	Go to File->Open Existing Project.
9.	Go to Run->Run app and launch the ImplicitIntent-ServiceHijack/Benign in which you installed/launched ImplicitIntent-ServiceHijack/Malicious
10. A message will be displayed saying "Malicious service started"   

# Steps to build the sample apps and re-produce the exploit

1. list targets:

    $ android list targets

2. available Android Virtual Devices:

    $ android list avd

3.  create an emulator:

    $ android create avd -n <name> -t <target>

4.  start emulator:

    $ emulator -avd <avd_name>

5. build and install *Malicious*:

    $ cd Malicious

    Make sure there is a file called local.properties with an entry sdk=/path/to/Android/sdk. Build will fail without this.

    $ ./gradlew installDebug

6.  build and install *Benign*:

    $ cd Benign

    Make sure there is a file called local.properties with an entry sdk=/path/to/Android/sdk. Build will fail without this.

    $ ./gradlew installDebug

7.  Open *Benign* in the emulator where you installed the app. A message will be displayed saying "Malicious service started".
