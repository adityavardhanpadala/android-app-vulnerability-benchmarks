# Summary
A broadcast receiver registered dynamically is exported by default.

# Versions of Android affected
All versions.

# Sample list of apps
Yet to be explored.

# Description of the vulnerability and the corresponding exploit.
Broadcast Receivers can register to receive messages (intents) statically in the manifest file (as shown in ExploitBroadCastReceiver1) or they be registered dynamically inside a .java file. Dynamically registering a broadcast receiver also exports the receiver automatically.

*Issue:* Since, dynamically registering a broadcast receiver exports a broadcast receiver, it can be triggered by any app, including unintended apps, via an intent.

*Example:* An example of this could be a broadcast receiver that is registered when an activity gets created and is unregistered when the activity is destroyed. See *MainActivity.java* in DynamicallyBroadcastReceiverRegistration-UnrestrictedAccess/Benign/app/src/main/java.../MainActivity.java.
When user leaves the particular activity the broadcast receiver registered with this activity is triggered and an email is sent to the app's developers informing them that the user left the app.
Meanwhile, just because the user left the activity, the system does not destroy it and because the activity is not destroyed the broadcast receiver is still registered to receive intents.
Also, since the BroadCastReceiver was registered dynamically it got exported by default. A malicious app can invoke this BroadCastReceiver and exploit it to send emails even if the malicious app is not authorized to send emails as shown in DynamicallyBroadcastReceiverRegistration-UnrestrictedAccess/Malicious/app/src/main/java/.../MalActivity.java.
Sending email is not very dangerous but the broadcast receiver exposed accidentally could very well be performing a more dangerous operation.


# Pre-requisites for build
Tested with Android Studio 2.3. Download [Android Studio](https://developer.android.com/studio/index.html)

# Steps to build the sample apps and re-produce the exploit with Android Studio
1.	Open Android Studio
2.	Go to Open Existing Project
3. 	Browse to ../DynamicallyBroadcastReceiverRegistration-UnrestrictedAccess/Benign
4.	Go to Run->Run app
5.	If devices is connected or emulator is running then app is launched.
6.	If device or emulator not connected then either connect a device or choose an existing emulator or click on "Create New Android Virtual Device".
7.	If you are connected to a device then app will be launched in the device. If you launched an existing emulator then app will be launched in the emulator. If you created a new virtual device then select it and launch the app in it.
8.  Go to File->Open abd browse to ../DynamicallyBroadcastReceiverRegistration-UnrestrictedAccess/Malicious.
9.  Go to Run->Run app and install/launch the malicious app in the same emulator/device in which the benign app was installed/launched.
10. Check the log of the benign app by clicking on "AndroidMonitor" at the bottom of the screen.
11. If the log contains a message "An email will be sent to rookie@malicious.com", you will know that the benign broadcast receiver was successfully invoked by the malicious app.

# Steps to build the sample apps and re-produce the exploit automatically
Coming soon
