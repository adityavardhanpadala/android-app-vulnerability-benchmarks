# Summary
Pending Intent with base intent empty can leak privilege.

# Android versions affected
Tested on Android 4.2 - Android 7.1

# Description of vulnerability and corresponding exploit
A pending intent is used by an application to enable a third party app to perform an action on its behalf
in the future. An example of this is the calendar app which sends a reminder 30 minutes before a meeting
starts. In this case the calendar app will create a pending intent with the reminder and the time the reminder
needs to be sent. The calendar app will send this pending intent to an app that can send notifications, which will perform
the action on behalf of the calendar app, at the time specified in the pending intent. Note that the Android system
will grant the app that can send notifications the same permissions as that of the calendar app while it
performs the prescribed action.


*Issue:* If a malicious app receives a pending intent whose base action is empty then the malicious app
can set an action and execute it in the context of the benign app that sent the pending intent. For example,
if the bening app has permission to write files to some location and it mistakenly sends a pending intent
whose base action is empty, then the malicious app can write files into that location without requesting
permissions from the user.

*Example:* An example of such an attack is illustrated in *EmptyPendingIntent-PrivilegeEscalation/app,EmptyPendingIntent-PrivilegeEscalation/BenignPartner,
Malicious*. *EmptyPendingIntent-PrivilegeEscalation/app* is a benign app that sends an empty pending intent to *EmptyPendingIntent-PrivilegeEscalation/BenignPartner*
which has a broadcast receiver *MyReceiver.java* that takes the pending intent and starts a service *MyService.java*
in *EmptyPendingIntent-PrivilegeEscalation/app* that performs an operation. The malicious app *EmptyPendingIntent-PrivilegeEscalation/Malicious*
has a broadcast receiver *MyReceiver.java* that intercepts the pending intent sent from *EmptyPendingIntent-PrivilegeEscalation/app*
and starts an internal service in *EmptyPendingIntent-PrivilegeEscalation/app* that performs some sensitive operation.
This service is not exported and is meant for internal use within the benign app. However, because of
the empty pending intent intercepted by the malicious broadcast receiever, the malicous app can escalate
its own privilege and can start *MySensitiveService* even though its not supposed to.


# Steps to re-produce the exploit automatically
Coming soon.
