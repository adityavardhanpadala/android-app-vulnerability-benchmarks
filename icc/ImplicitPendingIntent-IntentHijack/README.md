# Summary
Pending Intent with base intent implicit can be hijacked by a malicious app.

# Android versions affected
Tested on Android 4.2 - Android 7.1

# Description of vulnerability and corresponding exploit
A pending intent is used by an application to enable a third party app to perform an action on its behalf
in the future. An example of this is the calendar app which sends a reminder 30 minutes before a meeting
starts. In this case the calendar app will create a pending intent with the reminder and the time the reminder
needs to be sent. The calendar app will send this pending intent to an app that can send notifications, which will perform
the action on behalf of the calendar app, at the time specified in the pending intent. Note that the Android system
will grant the app that can send notifications the same permissions as that of the calendar app while it
performs the prescribed action.


*Issue:* To create a pending intent one has to specify a base intent which is the action that will be
performed in the future. This base intent can be an explicit or implicit intent to an activity, service,
broadcast receiver. If this base intent is an implicit intent then when the pending intent is performed,
a malicious app can intercept the implicit intent. If the implicit intent has sensitive information in it
then it will be leaked.

*Example:* An example of such an attack is illustrated in *ImplicitPendingIntent-IntentHijack/Benign,ImplicitPendingIntent-IntentHijack/BenignPartner, Malicious*. *ImplicitPendingIntent-IntentHijack/Benign* is a benign app that sends a pending intent to *ImplicitPendingIntent-IntentHijack/BenignPartner*.
The base intent inside the pending intent is an implicit intent
to *ImplicitPendingIntent-IntentHijack/Benign/.../MyService.java* and contains sensitive information like *password*.
*ImplicitPendingIntent-IntentHijack/BenignPartner* has a broadcast receiver *MyReceiver.java* that takes the pending intent and starts a service *MyService.java*
in *ImplicitPendingIntent-IntentHijack/Benign* that performs an operation. However, When the action in the pending intent
is performed from *BenignPartner*, the malicious service *ImplicitPendingIntent-IntentHijack/malicious/.../MalService* intercepts the
implicit intent and steals the password.


# Steps to re-produce the exploit automatically
Coming soon.
